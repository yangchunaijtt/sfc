顺风车业务暂定
最好12.30号完成
延迟解决：1月初
未解决剩余主要功能：
支付功能

顺风车微信注册小程序




12.15号 星期六
1：顺风车单页应用中乘客页、车主页的静态页面代码与测试。
2：mock数据取到并在三个页面单独渲染了出来，对mock数据进行了进一步的规划。
3：顺风车单页应用中全部行程页、详情页的设计样式、静态页面代码与测试。

1：对四个页面中数据进行写活，把数据动态获取到前端DOM中,
a标签向详情页传数据的功能，详情页数据的动态显示。
2：局部功能的全面完善，如：input点击向后台提交的数据,按钮能否操作点击，权限的问题

12.17日： 星期一：
1：对四个页面中数据进行写活，把数据动态获取到前端DOM中,
a标签向详情页传数据的功能，详情页数据的动态显示。
2：局部功能的全面完善，如：input点击向后台提交的数据,按钮能否操作点击，权限的问题


12.15号 修改点：
调用高德地图的  API
1：改下乘客页  和 车主页  的 input 显示，让他们送一点(已完成)


3：详情页 改为   地图API ：(已完成)
调整到 地图的API 动态 选择地址

4：车主  和  乘客 数据 动态写活 
( 暂时不做处理 )  (后台数据 还没有写好)
(目前 虚拟的 mock数据 和 真数据还是有差别的 )

2：点击选择地址时：动态渲染地址 
调用地图的 API
<script?type="text/javascript"?src="http://api.map.baidu.com/api?v=3.0&ak=FBDB5hh4zKMmVkvmDrkZzTVs"></script> 


12.15号  用 node.js 研究下推送 


12.17号
1：详情页 改为   高德地图定位：
2：使用高德地图API 来 选择上次位置和地点，静态页面，和基本功能实现。
3：每个 后台数据 的 类型写活，并传递参数来区别

1：高德地图 的 搜索点击功能
2：地图由点击改为滑动获的到哪里。

12.18日
要完成功能：输入显示搜索功能，
为找到定位显示定位失败，并提示他重新刷新 
点击搜索到的结果，到的地址变为 点击的地址 ，并出现小图标。
部分功能进一步完善，周三改交工了。

12.19号  星期三
待完成：
数据的写活	(
车主页   
乘客页
全部行程页中乘客页
全部行程中的车主页
)
局部功能和局部bug的修改(
例如：from表单提交的问题；(主要解决问题)
样式的修改(布局，字体，大小)，
地图页功能的修改
)
测试

本周任务：
地图待定功能：
1:可以选择城市
2：可以点击 始发地 来选择 出发地
选择是层级的(选择某个地方 跳出他的下级城市)
始发地 定位  调用 API 等一些方案
3：可以点击 目的地 来选择 目的地
选择是层级的
目的地 定位  选择 也调用一些 
 			4：地图视野有自动聚焦功能

完成方案：
1：新设页面 可以选择搜索城市 (附近的一些城市)
2：新设页面 
始发地和目的地 直接选择
3：根据提供的数据来判断是	
始发地 还是  目的地
4：地图视野函数  (自动定位功能已实现)
根据传的坐标 自动定位  
每次需要就调用
12.20号：


http://common.diditaxi.com.cn/general/webEntry?wx=true&biz=3#/?gjSubMenuId=huancheng
先出现城市选择，在跳出最常用到达点让人们选择。人们也可以选择搜索来查找常用地方。跳出地点定位图，最后点击确认上车点。
选择页	
包含
城市选择页，
常用点选择页(有搜索功能)
地图定位页
定位点击确认后，下方可以点击选择上车时间。

12.21号
完成功能：

待完成功能：
1：时间没弄好
2：经纬度标等参数为定义好
3：展示页数据的写活未完成
4：单子的成功与否未完成，未判断(后台有关，要商量)
5：后面与后台商量数据，数据的兼容性和格式问题。

今日完成功能：
1：搜索城市具体地址页面逻辑的编写
2：搜索城市页和城市具体地址页逻辑的实现，一些公用数据的同步，
城市选择页可使用地图API 
3：与后台给的文档做了解，了解支付功能，使用时间控件做时间选择逻辑。

待完成功能：
1：时间页代码实现。
2：支付功能。根据后台数据的定义，改变页面一些代码。










提供的接口：
http://qckj.czgdly.com/bus/MobileWeb/WxWeb-kongbatong/js/app.js 


页面调用下这个js
页面先获取下openid
          getOpenid(function(openid){
	       vMsg.uid = localCache("uid-kongbatong");
	       vMsg.openid = openid;
	       if(null == vMsg.uid || "" == vMsg.uid) {
                    register(); //返回注册登录页面
                } else {
                    initData(vMsg.uid); //加载页面数据
                }
        	},location.search);


12.24 号
3：用户登录(后台实现)
(1):初始化时就判断了
一：支付功能的实现(大头)
1：账号：
appid:?dbf34cab-2454-4f97-88f0-0a7e34aa426e
	app?Secret:?9712e23a-8802-47c6-ac9f-67b4b37ba75e 
2：支付功能：
我来实现
二：其他后台交接功能
1：没获取到，则返回登录页面(大头)
2：保存参数(大头)
3：数据的写活(中等任务)
先假mock,在真mock
4:阅读后台提供的文档，使用它提供的文档(大头)
三：bug的解决
1：点击奔溃的问题
2：页面的完善

步骤：
1：阅读后台提供的文档，使用它提供的文档(大头)
2：支付功能


12.24号
需求修改：
1：点击发布那些才能发布
执行原来的逻辑
2：其他点击是进行查看
看乘客端：都是需要付钱

12.24号
一：判断登录未登录
我只判断，登录交改后台处理。
逻辑问题。。。
二：登录后
1：乘客端显示	
(1)：全部行程显示他自己所有的单子
(2)：点击全部行程中的单个数据，是查看他单子的详情(特别说明)
有两个框，显示他们的信息，不可以输入修改，只能查看；
点击后，可以查看地图上的点，显示他的地址；
用户不在发布了；
(3)：点击输入框，仍然是进行行程的发布等，向后台发送数据。
2：车主端行程
(1)：作为车主端的身份的他自己所有的单子(包括失效，未失效部分)；
(2)：点击输入框，是进行车主业务的发布，
(3)点击全部行程
同上
3：全部行程
(1):乘客观察自己的单子是不需要付钱的
(2)：看车主单不要钱；
看乘客单是要付一块钱；用那个框架的数据；
用秒支付button的数据；
三：现在是跨域的，上传网上后，不是跨域的；
先按他给的格式模拟一个数据，用假数据来弄一个数据。
1：现在是跨域，很多数据给不到；


今日日志
1：确认完整需求，跟改页面布局和路由等
2：增加详情页，确认和实现详情页代码和样式，
详情页，用户可以看具体的信息，可以点击信息，
地图自动跳转聚焦
3：对接前后端文档和模块，准备新的mock数据，
跳转页面；

1：全部行程中支付功能的实现，
2：我负责的项目模块，新的数据mock的写，和调用。


12.25号
1：支付功能：(支付bug部分放后面)
使用 秒支付  button 的
   2：数据的写活(不是jsonp)
写个假 mock数据
向后台传送数据  可用 ajax发送 (快捷一点)
先用假数据格式 模拟；
3：写个支付信息列表
可以查看他查看的支付的信息
4：伪返回键

5：数据列表

1：查看用户发布信息列表
查看某个用户发布的所有信息
2：查看发布信息详情
查看用户发布信，点击详情页时使用（点击时发送请求）
3：发布顺风车信息
向后台发送顺风车数据的表
4：取消顺风车信息
乘客查看自己发布的信息时，
如果是发布出去的(状态是	为发布 (取消 和 失效  的 不能点击取消))，他可以点击取消功能，
取消发布；
5：查看发布信息后产生的支付信息列表
查看支付情况的表
12.27 日
后解决：
1：出发时间问题
2：到达时间问题
先解决：
3：先数据写活
bug处：
1：市级城市没有坐标问题 没提示


任务：
全部行程中是 有效的全部状态
乘客页 和 车主页 加个状态

明天解决：
订单问题
  几处css样式问题
  时间页面改用jquery插件
 支付的bug








12.28号任务

2：点击发布要返回首页
已解决，未出现问题
3：全部行程里的两页数据要是state为1时的数据，其他状态不显示
已解决，未进行完善的操作测试
5：部分页面css样式出现问题
如：时间页的确定  
我的支付要往右一点字体
已解决
7：bug处：
城市选择页的搜索没提示，
处理方案：点击时直接到具体选择页
 已解决
4：车主和乘客页要有显示订单的状态
已解决
1：支付页的数据的写活
已解决，数据未完成，未测试
9：ajax取数据时，时间写的市moth,没有添加
筛选，
做一个月改为全读
已解决：全部读取，后面做滑动加载。
8：css样式问题
数据很多css样式会bug 
检查：
1：乘客页数据没有问题
2：车主页数据没有问题
3：全部行程中车主页需要根改样式
测试解决
 					4：全部行程中的乘客页已解决
测试解决
5：选择处理页数据 已解决
改进没问题

bug处：
1：支付功能的实现和支付bug的解决
支付详情页的数据的写活
结果：订单已获取到数据，但报了json格式错误需要处理；
2：时间页面改用jquery的时间插件，以及时间数据的写活；
Mobiscroll 插件
????<script?src="js/mobiscroll.custom-2.16.1.min.js"></script>
????<script?src="js/mobiscroll.android-ics-2.5.2.js"></script>
http://qckj.czgdly.com/bus/MobileWeb/WxWeb-kongbatong/SpecialShutt	le_content.html
	参考?setTimeWheel()?方法


6:查看数据使用懒加载和瀑布流方式的查看
问题：后台一页页码多少条数据：
取滑动的距离来加载下一页。(乘客页 和 车主页 和 我的支付页需要这个)
根据页码来加载
infiniteScroll 插件
查看数据实现 滑动加载，在下面加载。
滑动加载infiniteScroll
参考  我的佣金  这个页面里面
	不想用插件就参考?我的车票?页面

 			

function setTimeWheel(){ 
	var dd = new Date(); 
	var currYear = dd.getFullYear(); 
	var opt={}; 
	//opt.datetime = { preset : 'datetime', minDate: new Date(2012,3,10,9,22), maxDate: new Date(2014,7,30,15,44), stepMinute: 5 }; 
	dd.setDate(dd.getDate()+1);//获取AddDayCount天后的日期 
	opt.sdatetime = {minDate: dd}; 
	opt.sdtdefault_0 = { 
	dateOrder: 'yymmddDD', 
	theme: 'android-ics light', //皮肤样式 
	display: 'bottom', //显示方式 
	mode: 'scroller', //日期选择模式 
	lang:'zh', 
	dateFormat: 'yyyy-mm-dd', 
	startYear:currYear, //开始年份 
	endYear:currYear + 1, //结束年份 
	stepMinute: 1, // More info about stepMinute: http://docs.mobiscroll.com/2-16-1/datetime#!opt-stepMinute 
	onSelect: function (valueText, inst) { 
	var sday = inst.getDate(); 
	var today = new Array('周日','周一','周二','周三','周四','周五','周六'); 
	
	//获取当前日期 
	var tmpNow = new Date(); 
	tmpNow.setDate(tmpNow.getDate()+1);//获取AddDayCount天后的日期 
	
	var dateArray = inst.getArrayVal(); 
	var week = today[sday.getDay()]; 
	var year = dateArray[0]; 
	var Month = parseInt(dateArray[1]) + 1; 
	var day = dateArray[2]; 
	var hour = dateArray[3]; 
	var minute = dateArray[4]; 
	
	if (sday < tmpNow){ 
	opt.sdatetime = {minDate: tmpNow}; 
	week = today[tmpNow.getDay()]; 
	year = tmpNow.getFullYear(); 
	Month = tmpNow.getMonth() + 1; 
	day = tmpNow.getDate(); 
	hour = tmpNow.getHours(); 
	minute = tmpNow.getMinutes(); 
	} 
	
	if (parseInt(Month) < 10) { 
	Month = "0" + Month; 
	} 
	
	if (parseInt(hour) < 10) { 
	hour = "0" + hour; 
	} 
	
	if (parseInt(minute) < 10) { 
	minute = "0" + minute; 
	} 
	
	if ($(this).hasClass("start_time_default")){ 
	$(this).removeClass("start_time_default").addClass("start_time only_one_time"); 
	} 
	var tmpStr = "<span class='date'>" + Month + "月" + day + "日" + "<b class='week'>" + week + "</b>" + hour + ":" + minute + "</span>" 
	$(this).html(tmpStr); 
	$(this).attr("data-val",valueText); 
	
	var optSDateTime_tmp = $.extend(opt['sdatetime'], opt['sdtdefault_0']); 
	$("#dt-a-0").mobiscroll().datetime(optSDateTime_tmp); 
	$("#dt-c-0").mobiscroll().datetime(optSDateTime_tmp); 
	$("#dt-a-1").mobiscroll().datetime(optSDateTime_tmp); 
	$("#dt-c-1").mobiscroll().datetime(optSDateTime_tmp); 
	
	changePriceByUCar(); 
	} 
	}; 
	
	var optSDateTime_0 = $.extend(opt['sdatetime'], opt['sdtdefault_0']); 
	$("#dt-a-0").mobiscroll().datetime(optSDateTime_0); 
	$("#dt-c-0").mobiscroll().datetime(optSDateTime_0); 
	$("#dt-a-1").mobiscroll().datetime(optSDateTime_0); 
	$("#dt-c-1").mobiscroll().datetime(optSDateTime_0); 
	
	} 









12.29号：
提示：
1：支付的完成
optional 里面传
uid 用户id
phone 用户手机号
usource 用户来源	 Wx_Kbt
FROID 发布单号：支付的id 

任务：
1：jquery无限滚动插件的应用：infiniteScroll 插件
2：jquery时间插件的应用：Mobiscroll 插件


5：支付后，并没有看到数据
已解决
6：全部行程中，展示所有乘客和车主的信息
查看自己的不付钱，查看别人的要付钱。
已完成
7：用户点击后，跳转到详情页
得区分有没有取消的权限，在给他取消订单的权限。
全部行程中车主和乘客没有取消订单的提示和权限
乘客页和车主页 有取消订单的提示和权限
已完成
8：支付详情页数据的写活和展示 
已完成
9：全部行程页展示的乘客和车主是所有人发布的有效的信息
已完成


1.1号：
1：jquery无限滚动插件的应用：infiniteScroll 插件
车主页 和	乘客页	和  全部行程中的乘客信息  和 车主信息
2：jquery时间插件的应用：Mobiscroll 插件
乘客页 和 车主页 发布消息时，要 填写 出发时间和期望到达时间

+
1.2号

滑动加载infiniteScroll
陈骏?2018/12/27?9:58:10
参考这个页面里面
不想用插件就参考?我的车票?页面 

	var $container = $( '#tasks .item').infiniteScroll({
		path: function() { 
			if (this.loadCount < pageCount){
				return "http://qckj.czgdly.com/bus/MobileWeb/madeCommission/queryPageMadeCommission_get.asp?uid=" + uid + "&cur=" + this.pageIndex;//cs.asp?page=
			}
		},
  		history: false,
		responseType: 'json',//格式要和itemSelector保持一致
		elementScroll: "#tasks",
		scrollThreshold: 50,
		//elementScroll: '#tasks',
		status: '.page-load-status',
		debug: true
		//hideNav: '#pages',
		//loadOnScroll: true,
		//checkLastPage: true
	});






1.3号
滑动加载infiniteScroll
乘客页 	车主页		支付页 	全部行程中的乘客页
全部行程中的车主页
1.(1)：查看用户发布信息列表
http://qckj.czgdly.com/bus/MobileWeb/madeFreeRideOrders/queryPageMadeFROrders_get.asp?

（2）：查看发布信息后产生的支付信息列表

http://qckj.czgdly.com/bus/MobileWeb/madeFROViewPayments/queryPageMadeFROVPayments_get.asp


注意：
1：上次网页的地址：
\\192.168.1.101\qckj\bus\MobileWeb\WxWeb-kongbatong
2：浏览的地址：
http://qckj.czgdly.com/bus/MobileWeb/WxWeb-kongbatong/sfc.html
       

https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx8973eff2c1fb5cb2&redirect_uri=http%3a%2f%2fqckj%2Eczgdly%2Ecom%2fbus%2fMobileWeb%2fWxWeb-kongbatong%2fuserCenter_content%2Ehtml&response_type=code&scope=snsapi_base&connect_redirect=1#wechat_redirect
